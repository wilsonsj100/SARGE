# Load necessary packages
library(data.table); library(tidyverse)
library(readxl); library(lubridate)
library(ggpubr); library(cowplot)
library(plotrix)
#Set year,month and date of files being processed
julian.date='2023-01-01'
#Read in your data
#setwd("C:/Users/wilsonsj/Dropbox (Smithsonian)/GENX2_Mesocosm_Data/current_data")
exo <- read.table("Example_Data/WILSON_ExoTable.dat", header=TRUE, skip=3, sep= ",")
head(exo)
#could consider putting these into a csv that then I read in for the EXO to be cleaner...
colnames(exo) <- c("TIMESTAMP","RECORD","Date","Time","Chlorophyll_RFU","Chlorophyll_ugL",
"Conductivity","FDOM_QSU","FDOM_RFU","NLF_conductivity",
"ODO_sat","ODO_local", "ODO_MgL", "Pressure_psia", "Salinity_PPT",
"Specific_Conductivity_uScm", "BGA_PE_RFU", "BGA_PE_ugL",
"TDS_mg_L","Turbidity_FNU","Wiper_Position_mv","pH","pH_mv","Temp_C",
"Depth_m","Battery_v","Cable_v","Wiper_Current_ma","sn","snn")
head(exo)
#now make a new column from the timestamp
# Make sure timestamp is recognized as date + time measured in EST
exo$TIMESTAMP <- ymd_hms(exo$TIMESTAMP, tz = "EST")
# Add fractional day of year (DOY) column
exo <- exo %>% mutate(fDOY = as.numeric(julian(exo$TIMESTAMP, julian.date)))
colnames(exo)[31] <- "fDOY"
exo$Depth_m <- as.numeric(exo$Depth_m)
exo$Conductivity <- as.numeric(exo$Conductivity)
head(exo)
## Plot
waterlev <- ggplot(exo, aes(x=TIMESTAMP, y=Depth_m)) + geom_point(color="blue") + ylim(-0.5,2.5) + xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
waterlev
## Plot conductivity
cond <- ggplot(exo, aes(x=TIMESTAMP, y=Salinity_PPT)) + geom_point(color="purple") +
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
cond
#Set year,month and date of files being processed
#julian.date='2023-01-01'
#Read in current water quality sonde (EXO2) data from SARGE
exo <- read.table("Example_Data/WILSON_ExoTable.dat", header=TRUE, skip=3, sep= ",")
#Quick look at the data
head(exo)
#could consider putting these into a csv that then I read in for the EXO to be cleaner...
colnames(exo) <- c("TIMESTAMP","RECORD","Date","Time","Chlorophyll_RFU","Chlorophyll_ugL",
"Conductivity","FDOM_QSU","FDOM_RFU","NLF_conductivity",
"ODO_sat","ODO_local", "ODO_MgL", "Pressure_psia", "Salinity_PPT",
"Specific_Conductivity_uScm", "BGA_PE_RFU", "BGA_PE_ugL",
"TDS_mg_L","Turbidity_FNU","Wiper_Position_mv","pH","pH_mv","Temp_C",
"Depth_m","Battery_v","Cable_v","Wiper_Current_ma","sn","snn")
head(exo)
#now make a new column from the timestamp
# Make sure timestamp is recognized as date + time measured in EST
exo$TIMESTAMP <- ymd_hms(exo$TIMESTAMP, tz = "EST")
# Add fractional day of year (DOY) column
exo <- exo %>% mutate(fDOY = as.numeric(julian(exo$TIMESTAMP, julian.date)))
colnames(exo)[31] <- "fDOY"
exo$Depth_m <- as.numeric(exo$Depth_m)
exo$Conductivity <- as.numeric(exo$Conductivity)
head(exo)
## Plot
waterlev <- ggplot(exo, aes(x=TIMESTAMP, y=Depth_m)) + geom_point(color="blue") + ylim(-0.5,2.5) + xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
waterlev
## Plot conductivity
cond <- ggplot(exo, aes(x=TIMESTAMP, y=Salinity_PPT)) + geom_point(color="purple") +
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
cond
# Load necessary packages
library(data.table); library(tidyverse)
library(readxl); library(lubridate)
library(ggpubr); library(cowplot)
library(plotrix)
#
#read in hydrologic data from Sontek IQ (Xylem Analytics)
sontek <- read.table("Example_Data/WILSON_SontekTable.dat", header=TRUE, skip=1, sep= ",")
sontek <- sontek[-(1:3), ]
sontek <- as.tibble(sontek)
head(sontek)
#colnames(sontek) <- c("TIMESTAMP","RECORD","SONTEK_ID","Sample_number","yyyy","MM","dd","hh","Minute","ss","Flowrate",             "Stage","Mean_velocity","Total_volume","Water_depth","Index_velocity","Cross_area","Water_temperature",                 "System_status","Velocity_XZxc","Velocity_XZzc","Velocity_XZxL","Velocity_XZxR","Batt_Vol_Sontek",                     "Pitch_angle","Roll_angle","Perc_submergance","IceScore","TS","RN","","","","","","","","","m","m","m/s",              "m3","m","m/s","m2","Celsius","unitless","m/s","m/s","m/s","m/s","volts","degrees","degrees","percent",                 "integer")
#Make a new timestamp column that is recognized as date + time measured in the timezone needed:
sontek$TIMESTAMP <- ymd_hms(sontek$TIMESTAMP, tz = "EST")
#Ensure that columns that should be numbers are numeric for plotting:
sontek$Flowrate <- as.numeric(sontek$Flowrate)
sontek$Water_depth <- as.numeric(sontek$Water_depth)
## Plot Sontek Flow Data:
flow <- ggplot(sontek, aes(x=TIMESTAMP, y=Flowrate)) + geom_point(color="black") +       xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
flow
## Plot Index Velocity or Water flow Velocity
flow1 <- ggplot(sontek, aes(x=TIMESTAMP, y=as.numeric(Index_velocity))) + geom_point(color="black") +
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
flow1
## Plot water depth measured by the sontekIQ
sdepth <- ggplot(sontek, aes(x=TIMESTAMP, y=Water_depth)) + geom_point(color="darkblue") +
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
sdepth
#can plot other variables as needed
#Note that similar code could be used with a LI7820 N2O Analyzer
#read in gas concentration data from the LI7810 (LI-COR)
flux <- read.table("Example_Data/WILSON_FLUX_7810.dat", header=TRUE, skip=1, sep= ",")
flux <- flux[-(1:2), ]
#Take a quick look at the dataframe created
head(flux)
#Make a new timestamp column that is recognized as date + time measured in the timezone needed:
sontek$TIMESTAMP <- ymd_hms(sontek$TIMESTAMP, tz = "EST")
#Ensure that columns that should be numbers are numeric for plotting:
flux$CH4d_ppmA <- as.numeric(flux$CH4)
flux$CO2d_ppmA <- as.numeric(flux$CO2)
## Plot CH4 Data (Note: these are raw concentrations, not in water concentrations)
ghg_CH4 <- ggplot(flux, aes(x=TIMESTAMP1, y=CH4d_ppmA)) + geom_point(color="darkviolet")+
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + ylim(0,500000)+
theme_classic()
ghg_CH4
## Plot CH4 Data (Note: these are raw concentrations, not in water concentrations)
ghg_CH4 <- ggplot(flux, aes(x=TIMESTAMP, y=CH4d_ppmA)) + geom_point(color="darkviolet")+
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + ylim(0,500000)+
theme_classic()
ghg_CH4
#Note that similar code could be used with a LI7820 N2O Analyzer
#read in gas concentration data from the LI7810 (LI-COR)
flux <- read.table("Example_Data/WILSON_FLUX_7810.dat", header=TRUE, skip=1, sep= ",")
flux <- flux[-(1:2), ]
#Take a quick look at the dataframe created
head(flux)
#Make a new timestamp column that is recognized as date + time measured in the timezone needed:
flux$TIMESTAMP1 <- ymd_hms(flux$TIMESTAMP, tz = "EST")
#Ensure that columns that should be numbers are numeric for plotting:
flux$CH4d_ppmA <- as.numeric(flux$CH4)
flux$CO2d_ppmA <- as.numeric(flux$CO2)
## Plot CH4 Data (Note: these are raw concentrations, not in water concentrations)
ghg_CH4 <- ggplot(flux, aes(x=TIMESTAMP1, y=CH4d_ppmA)) + geom_point(color="darkviolet")+
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + ylim(0,500000)+
theme_classic()
ghg_CH4
## Plot CO2 Data (Note: these are raw concentrations, not in water concentrations)
ghg_CO2 <- ggplot(flux, aes(x=TIMESTAMP1, y=CO2d_ppmA)) + geom_point(color="darkred")+
xlim(c(as.POSIXct('2024-09-19 00:00:00', format = "%Y-%m-%d %H:%M:%S"),
as.POSIXct('2024-09-28 00:00:00', format = "%Y-%m-%d %H:%M:%S"))) + theme_classic()
ghg_CO2
